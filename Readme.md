# Сайт компании медицинской диагностики

--------------------------


Сайт написан с помощью фреймворка Django v4.2.7 с применением следующего стека:

PostgresSQL
Django
Templates
Forms
Auth
Git
ORM 
Docker

------------------------
## Настройки файла .env

POSTGRES_USER=имя пользователя postgresql
POSTGRES_PASSWORD=пароль пользователя postgresql
POSTGRES_DB=имя базы данных для проекта
POSTGRES_HOST=<имя контейнера с базой> в случае докера
POSTGRES_PORT=порт для базы postgresql
SECRET_KEY=секретный ключ Django
REDIS_HOST=<имя контейнера с базой> из докера
REDIS_PORT=порт для redis

------------------------

## Приложения

1. users - приложение для пользователей и врачей, при регистрации пользователь указывает роль: пациент или врач. Создается общая модель User. Список врачей наполняет модератор с правами доступа is_staff или is_superuser. Врач это расширенная модель пользователя, с возможностью просматривать список своих записей приемов пациентов. 
2. speciality - приложение для специализации медицинских услуг. Объединяет медицинские услуги по направлениям диагностики, с возможностью вывода списка направлений диагностики, списка услуг по направлению.
3. services - приложение для медицинских услуг. Выводит список услуг, информацию о конкретной услуге.
4. appointments - приложение для записи на медицинскую услугу. Реализована запись на медицинскую услугу к определенному врачу, или с выбором врача из списка. Можно записаться только на свободное время у врача и только на рабочие дни врача, указанные в модели timetable. При запуске через Docker, автоматически запускается задача, которая отслеживает и меняет статусы записей с истекшим сроком давности)
5. main - приложение для вывода основной информации на главную страницу. Выводит 3 рандомных услуги и 3 рандомных врача.
------------------------------------
## Модели и поля


1. **User** - модель для работы с пользователем сайта (наследуется от AbstractUser)
    - username (*None*)
    - email - поле для ввода e-mail (переопределяется для *USERNAME_FIELD*)
    - phone - поле для ввода телефона (*необязательное*)
    - avatar - аватар пользователя
    - first_name - Имя пользователя
    - last_name - Фамилия пользователя
    - date_of_birth - День рождения
    - role - роль (пациент или доктор, для модератора, по этому полю проще искать врачей, для создания расширенной модели Doctor)
2. **Speciality** - модель для специализации направлений услуг.
    - speciality_name - название специализации
    - description - описание специализации
    - image - поле для добавления картинки
3. **Service** - модель медицинская услуга
    - title - название услуги
    - image - картинка для описания услуги
    - price - стоимость услуги
    - speciality - специализация услуги, внешний ключ, объединяющий услуги по специализации
    - description - описание услуги
4. **Doctor** - Расширенная модель User.
    - user - ссылка на основную модель пользователя при регистрации
    - speciality - внешний ключ к специализации врача
    - education - образование врача
    - experience - стаж работы
    - description - описание врача
5. **Timetable** - расписание работы врача.
    - day_of_visit - рабочие дни недели
    - doctor - внешний ключ к модели **Doctor** (*ManyToManyField*)
6. **Appointment** - модель записи к врачу.
    - user - внешний ключ к модели пациента
    - doctor - внешний ключ к модели врача (расширенная модель User)
    - service - внешний ключ к модели медицинской услуги
    - date - дата оказания услуги
    - time - время оказания услуги
    - data_created - дата и время создания заказа (*default: now*)
    - status_of_appointment - статус заказа, (WAITING, COMPLETED, CANCELLED)
    - price - стоимость услуги
------------------------------------   
## Регистрация нового пользователя

Для доступа в личный кабинет и возможности создания и управления заказами, новому пользователю необходимо пройти процедуру регистрацию.

### Инструкция по регистрации:
 
- перейти по ссылке "Регистрация" в правом верхнем углу главного меню или на странице входа
- ввести действующий e-mail и придумать пароль (не менее 8 символов, минимум одна буква и цифра)
- перейти по ссылке, которая придет на указанную почту
- ввести свой e-mail и пароль на странице входа на сайт

------------------------------------ 
## Работа с личным кабинетом

В личном кабинете пользователя будет отображаться информация о пользователе, введенная при регистрации и его записи к врачу.

### В личном кабинете пользователь может:
 
- отредактировать личную информацию
- изменить созданную запись

**После любого действия с записью в личном кабинете, на почту пользователя автоматически будет отправлено сообщение с информацией о внесенных изменениях**

### В личном кабинете врач может:
 
- отредактировать личную информацию
- изменить или просмотреть записи своих пациентов

------------------------------------ 
## Валидации
На сайте предусмотрены валидации прав доступа пользователей, а так же валидация вводимой информации при создании нового заказа.

### Валидация полей формы заказа:

- пользователь может выбрать услугу и врача, только в том случае, если врач оказывает такую услугу
- запись начинается только со следующего дня (нельзя выбрать прошедший или текущий день)
- нельзя выбрать время вне времени работы клиники (с 10:00 до 19:00)
- нельзя выбрать дату записи, если в этот день у врача нет приема
- заказ будет успешно создан, только если в выбранный день у врача будет свободное время (длительность любой процедуры по-умолчанию 1 час)

------------------------------------ 

## Docker compose
1) Собрать образ и запустить контейнер с помощью команды: docker compose up --build
2) Для остановки и удаления контейнеров используйте Ctrl + C.